<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"  lang="en-us">
    <title>Using R as a Computer Algebra System with Ryacas - Econometrics and Free Software</title>
    <meta name="generator" content="Hugo 0.18.1" />

    
    <meta name="description" content="A website built through Hugo and blogdown.">
    
    <link rel="canonical" href="https://b-rodrigues.github.io/bookshelf/blog/2013-12-31-r-cas/">
    
    <meta name="author" content="Bruno Rodrigues">
    
    <meta name="generator" content="Hugo 0.18.1" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:url" content="https://b-rodrigues.github.io/bookshelf/blog/2013-12-31-r-cas/">
    <meta property="og:title" content="Econometrics and Free Software">
    <meta property="og:image" content="https://b-rodrigues.github.io/bookshelfmap[width:50 height:50 alt:Logo url:logo.png]">
    <meta name="apple-mobile-web-app-title" content="Econometrics and Free Software">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="shortcut icon" type="image/x-icon" href="../../images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="../../images/favicon.ico">

    
    <link rel="stylesheet" href="../../css/bootstrap.min.css" media="screen">
    <link rel="stylesheet" href="../../css/custom.css">
    <link rel="stylesheet" href="../../css/pygments.css">
    
    <link rel="stylesheet" href="../../css/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../css/helpers/jquery.fancybox-buttons.css?v=1.0.5" type="text/css" media="screen" />
  </head>
  <body>


<div class="row">
<div class="navbar navbar-default navbar-fixed-top">
<div class="container">
  <div class="navbar-header">
    <a href="https://b-rodrigues.github.io/bookshelf" class="navbar-brand">Econometrics and Free Software</a>
    <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
  </div>
  <div class="navbar-collapse collapse" id="navbar-main">

    <ul class="nav navbar-nav navbar-right">
      <li><a href="https://github.com/b-rodrigues/">Github</a></li>
      <li><a href="https://twitter.com/brodriguesco/">Twitter</a></li>
    </ul>
  </div>
</div>

</div>

<div class="container">

  <div>
    <div class="row">
      <div class="col-lg-3 col-md-3 col-sm-4">
        

<div class="list-group table-of-contents">

  
    <a class="list-group-item" href=#><b>About Me</b></a>
    
    <div class="list-group">
      
      <a class="list-group-item" href="../../bookshelf/about/research/">Research</a>
      
      <a class="list-group-item" href="../../bookshelf/about/software/">Software</a>
      
      <a class="list-group-item" href="../../bookshelf/about/about/">Who am I?</a>
      
    </div>
    
  
    <a class="list-group-item" href=#><b>Blog</b></a>
    
    <div class="list-group">
      
      <a class="list-group-item" href="../../bookshelf/blog/2017-02-17-how_to_use_jailbreakr/">How to use jailbreakr</a>
      
      <a class="list-group-item" href="../../bookshelf/blog/2016-12-24-functional-programming-and-unit-testing-for-data-munging-with-r-available-on-leanpub/">Functional programming and unit testing for data munging with R available on Leanpub</a>
      
      <a class="list-group-item" href="../../bookshelf/blog/2017-01-07-my-free-book-has-a-cover/">My free book has a cover!</a>
      
      <a class="list-group-item" href="../../bookshelf/blog/2016-12-21-work-on-lists-of-datasets-instead-of-individual-datasets-by-using-functional-programming/">Work on lists of datasets instead of individual datasets by using functional programming</a>
      
      <a class="list-group-item" href="../../bookshelf/blog/2013-01-29-method-of-simulated-moments-with-r/">Method of Simulated Moments with R</a>
      
      <a class="list-group-item" href="../../bookshelf/blog/2012-12-11-new-website/">New website!</a>
      
      <a class="list-group-item" href="../../bookshelf/blog/2013-11-07-gmm-with-rmd/">Nonlinear Gmm with R - Example with a logistic regression</a>
      
      <a class="list-group-item" href="../../bookshelf/blog/2013-01-16-simulated-maximum-likelihood-with-r/">Simulated Maximum Likelihood with R</a>
      
      <a class="list-group-item" href="../../bookshelf/blog/2015-11-11-bootstrapping-did-with-r/">Bootstrapping standard errors for difference-in-differences estimation with R</a>
      
      <a class="list-group-item" href="../../bookshelf/blog/2016-06-21-careful-with-trycatch/">Careful with tryCatch</a>
      
      <a class="list-group-item" href="../../bookshelf/blog/2016-07-18-data-frame-columns-as-arguments-to-dplyr-functions/">Data frame columns as arguments to dplyr functions</a>
      
      <a class="list-group-item" href="../../bookshelf/blog/2015-02-22-export-r-output-to-file/">Export R output to a file</a>
      
      <a class="list-group-item" href="../../bookshelf/blog/2016-11-04-ive-started-writing-a-book-functional-programming-and-unit-testing-for-data-munging-with-r/">I&#39;ve started writing a &#39;book&#39;: Functional programming and unit testing for data munging with R</a>
      
      <a class="list-group-item" href="../../bookshelf/blog/2015-01-12-introduction-to-programming-econometrics-with-r/">Introduction to programming econometrics with R</a>
      
      <a class="list-group-item" href="../../bookshelf/blog/2016-07-30-merge-a-list-of-datasets-together/">Merge a list of datasets together</a>
      
      <a class="list-group-item" href="../../bookshelf/blog/2014-04-23-r-s4-rootfinding/">Object Oriented Programming with R: An example with a Cournot duopoly</a>
      
      <a class="list-group-item" href="../../bookshelf/blog/2014-11-11-benchmarks-r-blas-atlas-rro/">R, R with Atlas, R with OpenBLAS and Revolution R Open: which is fastest?</a>
      
      <a class="list-group-item" href="../../bookshelf/blog/2016-07-26-read-a-lot-of-datasets-at-once-with-r/">Read a lot of datasets at once with R</a>
      
      <a class="list-group-item" href="../../bookshelf/blog/2016-03-31-unit-testing-with-r/">Unit testing with R</a>
      
      <a class="list-group-item" href="../../bookshelf/blog/2015-05-03-update-introduction-r-programming/">Update to Introduction to programming econometrics with R</a>
      
      <a class="list-group-item" href="../../bookshelf/blog/2013-12-31-r-cas/">Using R as a Computer Algebra System with Ryacas</a>
      
    </div>
    
  

</div>

      </div>
      <div class="col-lg-9 col-md-9 col-sm-8">
        <div>
           <h1 id="main">Using R as a Computer Algebra System with Ryacas</h1>
           <span class="article-date">December 31, 2013</span>
        </div>
        <!-- MathJax scripts -->

<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<p></head></p>

<p><body>
<p>R is used to perform statistical analysis and doesn&#39;t focus on symbolic maths. But it is sometimes useful to let the computer derive a function for you (and have the analytic expression of said derivative), but maybe you don&#39;t want to leave your comfy R shell. It is possible to turn R into a full-fledged computer algebra system. CASs are tools that perform symbolic operations, such as getting the expression of the derivative of a user-defined (and thus completely arbitrary) function. Popular CASs include the proprietary Mathematica and Maple. There exists a lot of CASs under a Free Software license, Maxima (based on the very old Macsyma), Yacas, Xcas&hellip; In this post I will focus on Yacas and the <code>Ryacas</code> libarary. There is also the possibility to use the <code>rSympy</code> library that uses the <code>Sympy</code> Python library, which has a lot more features than Yacas. However, depending on your operating system installation can be tricky as it also requires <code>rJava</code> as a dependency. </p></p>

<p>Even though <code>Ryacas</code> is quite nice to have, there are some issues though. For example, let&#39;s say you want the first derivative of a certain function f. If you use <code>Ryacas</code> to get it, the returned object won&#39;t be a function. There is a way to &ldquo;extract&rdquo; the text from the returned object and make a function out of it. But there are still other issues; I&#39;ll discuss them later.</p>

<h2>Installation</h2>

<p>Installation should be rather painless. On Linux you need to install Yacas first, which should be available in the major distros&#39; repositories. Then you can install <code>Ryacas</code> from within the R shell. On Windows, you need to run these three commands (don&#39;t bother installing Yacas first):</p>

<pre><code>install.packages(&#39;Ryacas&#39;)
library(Ryacas)
yacasInstall()
</code></pre>

<p>You can find more information on the <a href="https://code.google.com/p/ryacas/#INSTALLATION">project&#39;s page</a>.</p>

<h2>Example session</h2>

<p>First, you must load <code>Ryacas</code> and define symbols that you will use in your functions.</p>

<pre><code class="r">require(&quot;Ryacas&quot;)
</code></pre>

<pre><code>## Loading required package: Ryacas Loading required package: XML
</code></pre>

<pre><code class="r">x &lt;- Sym(&quot;x&quot;)
</code></pre>

<p>You can then define your fonctions:</p>

<pre><code class="r">my_func &lt;- function(x) {
    return(x/(x^2 + 3))
}
</code></pre>

<p>And you can get the derivative for instance:</p>

<pre><code class="r">my_deriv &lt;- yacas(deriv(my_func(x), x))
</code></pre>

<pre><code>## [1] &quot;Starting Yacas!&quot;
</code></pre>

<p>If you check the class of <code>my_deriv</code>, you&#39;ll see that it is of class <code>yacas</code>, which is not very useful. Let&#39;s «convert» it to a function:</p>

<pre><code class="r">my_deriv2 &lt;- function(x) {
    eval(parse(text = my_deriv$YacasForm))
}
</code></pre>

<p>We can then evaluate it. A lot of different operations are possible. But there are some problems.</p>

<h2>Issues with Ryacas</h2>

<p>You can&#39;t use elements of a vector as parameters of your function, i.e.:</p>

<pre><code class="r">theta &lt;- Sym(&quot;theta&quot;)
func &lt;- function(x) {
    return(theta[1] * x + theta[2])
}
# Let&#39;s integrate this
Func &lt;- yacas(Integrate(func(x), x))
</code></pre>

<p>returns <code>(x^2*theta)/2+NA*x;</code> which is not quite what we want&hellip;there is a workaround however. Define your functions like this:</p>

<pre><code class="r">a &lt;- Sym(&quot;a&quot;)
b &lt;- Sym(&quot;b&quot;)
func2 &lt;- function(x) {
    return(a * x + b)
}
# Let&#39;s integrate this
Func2 &lt;- yacas(Integrate(func2(x), x))
</code></pre>

<p>we get the expected result: <code>(x^2*a)/2+b*x;</code>. Now replace <code>a</code> and <code>b</code> by the thetas:</p>

<pre><code class="r">Func2 &lt;- gsub(&quot;a&quot;, &quot;theta[1]&quot;, Func2$YacasForm)
Func2 &lt;- gsub(&quot;b&quot;, &quot;theta[2]&quot;, Func2)
</code></pre>

<p>Now we have what we want: </p>

<pre><code class="r">Func2
</code></pre>

<pre><code>## [1] &quot;(x^2*theta[1])/2+theta[2]*x;&quot;
</code></pre>

<p>You can then copy-paste this result into a function.</p>

<p>Another problem is if you use built-in functions that are different between R and Yacas. For example:</p>

<pre><code class="r">my_log &lt;- function(x) {
    return(sin(log(2 + x)))
}
</code></pre>

<p>Now try to differentiate it:</p>

<pre><code class="r">dmy_log &lt;- yacas(deriv(my_log(x), x))
</code></pre>

<p>you get: <code>Cos(Ln(x+2))/(x+2);</code>. The problem with this, is that R doesn&#39;t recognize <code>Cos</code> as the cosine (which is <code>cos</code> in R) and the same goes for <code>Ln</code>. These are valid Yacas functions, but that is not the case in R. So you&#39;ll have to use <code>gsub</code> to replace these functions and then copy paste the end result into a function.</p>

<h2>Conclusion</h2>

<p>While it has some flaws, <code>Ryacas</code> can be quite useful if you need to derive or integrate complicated expressions that you then want to use in R. Using some of the tricks I showed here, you should be able to overcome some of its shortcomings. If installation of <code>rJava</code> and thus <code>rSympy</code> becomes easier, I&#39;ll probably also do a short blog-post about it, as it has more features than <code>Ryacas</code>.</p>

<p></body></p>

      </div>
    </div>
  <div class="row">
    <div class="col-lg-9 col-md-9 col-sm-8 col-lg-offset-3 col-md-offset-3">
    <footer>
  <div class="row">
    <div class="col-lg-12">
      <p>Copyright 2017. <a> Bruno Rodrigues</a> </p>
      <p>Made with the HUGO theme <a href="https://github.com/adejoux/hugo-darkdoc-theme" rel="nofollow">darkdoc</a>.</p>
    </div>
  </div>
</footer>

</body>

    </div>
  </div>

</div>
</html>
<script>

  var api_url = '';

</script>
<script src="//code.jquery.com/jquery-2.2.3.min.js"></script>
<script src="../../js/application.js"></script>
<script type="text/javascript" src="../../js/jquery.fancybox.pack.js?v=2.1.5"></script>
<script type="text/javascript" src="../../js/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script type="text/javascript" src="../../js/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../../js/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<script type="text/javascript">
  $(document).ready(function() {
    $(".fancybox").fancybox();
  });
</script>

